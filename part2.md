## ビジネスメタをオントロジーで書く - Part 2

### どうすれば試せるか？

「オントロジーベースのデータカタログ」というコンセプトを実際に試すにはどうすればよいか。基本的な構成要素として、まずビジネスメタの説明対象である「物理メタ」が必要である。そしてオントロジーで書かれる「ビジネスメタ」、それを解釈する「生成AI」ということになるだろう。生成AIにはフォーマルなオントロジーを記述するためのコーディング・アシスタントとしての役割もある。

データベースには様々な種類があるが、まずはコンベンショナルなSQLテーブルで試すことにする。実際のサンプルとしてMS系のDBのオマケとして知られる[NorthwindのDDL](https://github.com/microsoft/sql-server-samples/blob/master/samples/databases/northwind-pubs/instnwnd.sql)を使用する。これはGitHubから簡単に手に入る。

生成AIにはGemini CLIを使い、ローカル上のファイルをいろいろ読んだり書いたりしてもらう。オントロジーファイルを人間が参照するのに[Protégé](https://protege.stanford.edu/)のようなオントロジーエディタも準備しておく。

### DDLから「素の」オントロジーを生成する

NorthwindのDDLを拾ってきて、早速Gemimi CLIに[MermaidでER図](https://github.com/Yoshiyuki-iasa/northwind/northwind_schema.md)を書いてもらう。

これらのテーブルや属性の説明を、これからオントロジーで書いていくわけだが、DDLはオントロジーには存在しない概念 (例えばオントロジーエディタはDDLを解釈できない) なので、オントロジーで通用する何らかの概念なりオブジェクトなりに置き換える必要がある。

ここで登場するのがSHACLである。これは本来グラフデータのバリデーションルールを書くためのもので、SQLテーブルの物理メタ表現に使える、といった直接の言及はネット上にも存在しない。しかし型制約なんてグラフデータもSQLテーブルも似たようなものだろう。そんな素人考えも今や生成AIのおかげで簡単に検証出来るようになった。人間は知らなくとも、Geminiはそれが可能であることを知っていて、実際に[SHACLも書いてくれる](https://github.com/Yoshiyuki-iasa/northwind/instnwnd.shacl.ttl)のである。

もちろんこれは抜け漏れも有りえる「近似値」であり、コマーシャルなサービスでは、データソースの種類別にSHACL生成プログラムを用意するべきであろう (Geminiもおそらく内部的にDDLを解析、Pythonだかでコードを生成・実行している)。しかしなんのことはない、クローラが自動収集したり、或いは手で書いたりする物理メタの形式をSHACLにするだけの話である。

このSHACLファイルから連続技でオントロジーを生成する。これもそんなことはネットに書いてないが、バリデーションルールからその対象も当然リバース出来るだろう、という思いつきである。[出来たファイル](https://github.com/Yoshiyuki-iasa/northwind/northwind_ontology_pt2.ttl)はProtégéでもちゃんと開くことが出来る。

このオントロジーファイルから[クラス図](https://github.com/Yoshiyuki-iasa/northwind/northwind_ontology_diagram.md)を起こすこともできる。最初にDDLから生成したER図と見比べてみると、大体合っていそうであることがわかる。

これは現段階では物理メタしか持たない「素の」オントロジーである。データソースやDDLがあればここまで自動生成であり、クローラで物理メタを拾ってくるのと何ら変わりはない。

ここからいよいよHuman in the loopの出番で、ビジネスメタを付け加えることでオントロジーを育てていくことになる。まずはその下準備から始めよう。

(Part3につづく)
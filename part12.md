## ビジネスメタをオントロジーで書く - Part 12

### RDFデータセットの中にあるもの

Protégéで書くような、或いは前回の最後に`CONSTRUCT`句で出力したようなturtle形式のRDFはテキストエディタで開いて中身を読むことができる。一方Fusekiの中を見るにはSPARQLクエリを投げなければならない。両者を見比べることで、RDFの基本的な概念や文法を知る手がかりにしよう。

---

#### 「リソース」と「リテラル」

RDFとは、「互いに関連するコトバのカタマリ」な訳だが、この「コトバ (RDF Terms) は、まず大きく「リソース」と「リテラル」という2種類に分けられる。「リソース」は「名前」、リテラルは「値」である。名前も値も文字にすれば同じではないか。だがとこれらは視覚的に簡単に見分けることが出来る。

FusekiのWebUIのクエリ入力欄の上に水色のボタンがふたつ並んでいて、これを押すと簡単なクエリが入力される。とりあえず左側の"Selection of triples"を押して、入力欄の右上隅にある"Run query"ボタンを押すと、クエリ欄の下に結果が表示される。

「トリプルの`SELECT`」なので結果は主語 (Subject)・述語 (Predicate)・目的語 (Object) の3列で表示されている。主語と述語は全てURLリンクのように表示されるURIだが、目的語にはURIの他に「ただの文字列 (=値)」がチラホラと見受けられる。

つまり「青いのがリソース、黒いのがリテラル」で簡単にも訳が付く、というわけである。「リソース」をひとつ画面から拾ってみよう。

`<http://example.org/meta#hasEntityConcept>`

RDFではURIを`<>`で囲むのが決まりである。上の文字列で`#`までがあの「名前空間」である。このリソースをプレフィクスを使って書くと`meta:hasEntityConcept`となる。turtle形式のファイルで使われるのがこちらの表記で、「短縮URI」とか、「修飾名 (QName)」、或いはざっくりと「語彙 (vocabulary) と呼ぶ (RDFの世界では同じ概念の呼び名がコンテキストによりコロコロ変わるが、この辺は知識と経験が要るようである)。

---

#### 「クラスとプロパティ」と「RDFトリプル」
「リソース」はさらに役割で「クラス (種類)」と「プロパティ (属性)」などに分けられる。ここで「分けられる」と書いたのには訳があって、「リソースそのものにいくつか種類ある」のではなく、「RDFトリプル表現によって分けられる」からである。例えばこうだ。並び順が英語のSVOなので、そこは日本語の語順に脳内変換すると良い。

[主語] `<http://example.org/northwind#Employees>` 「`nw:Employees`は」

[述語] `<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>`  「`rdf:type`です」

[目的語] `<http://www.w3.org/2002/07/owl#Class>` 「`owl:Class`という」

あるいはこうである。

[主語] `<http://example.org/meta#hasEntityConcept>` 「`meta:hasEntityConcept`は」

[述語] `<http://www.w3.org/1999/02/22-rdf-syntax-ns#type>`  「`rdf:type`です」

[目的語] `<http://www.w3.org/2002/07/owl#ObjectProperty>` 「`owl:ObjectProperty`という」

前回のオントロジー・ヘッダーとて例外ではない。

[主語] `ac:` は、[述語]  `rdf:type` です [目的語] `owl:Ontology` という

クラスかプロパティかはトリプルによる宣言、ということは、クラスとプロパティ両方を同一の主語で宣言することも出来る、ということになるが、これはベストプラクティスではないそうである。また、クラス用のリソースは大文字始まり (`ex:Employees`)、プロパティはいわゆるキャメルケース (`ex:hasValue`) で書く、という慣例もあるそうで、あるリソースがクラスかプロパティかの見分けはある程度付けられるし、逆に作る側としてはそういうセンスが求められる、ともいえる。オントロジーは意味論の世界なので、コトバの「名前」と「意味」の書きっぷりは重要な品質指標のひとつだろう。LLMに読ませるなら尚更である。

ここでも分かる通り、主語と述語はリソース、目的語はリソースないしリテラルの何れか、である。主語にはクラス、プロパティ両方が使われる。述語に使われるのはプロパティのみである (これも理由は「論理が破綻するから」で、文法云々の事情ではない)。

ちなみにRDFにはほかにもインスタンス (`owl:NamedIndividual`) というタイプももちろんあるが、このNorthwindの例では登場機会は無い。なぜならこれは「メタデータ」だから、である。逆に言えば「メタデータ」とは「インスタンスを含まないデータ」である。

---

#### 目で見るRDFトリプル

RDFトリプルは実際にはどこでどのように見えるのか、実物で確認してみよう。まずはturtle形式である。これはオントロジーファイルをコードエディタで開けばよい。

```turtle
meta:hasEntityConcept
        rdf:type    owl:ObjectProperty;
        rdfs:label  "has entity concept" .
```

ここではトリプルがふたつ書かれている。最初の行が共通の主語、2行目と3行目にそれぞれ述語と目的語が書かれている (また2行目の目的語はリソース、3行目はリテラルであることもわかる)。この「上のコードブロックで囲った部分」を「プロパティ・リスト」とか「リソース記述」とか呼ぶそうである。これをSPARQLで抜く ("Selection of triple"のクエリの最初に`PREFIX meta: <https://krr.triply.cc/krr/sameas-meta/def/>`、`WHERE`句の下に`BIND (meta:hasEntityConcept AS ?subject)`を追加する) とこうなる。

| subject | predicate | object |
|---|---|---|
| http://example.org/meta#hasEntityConcept | http://www.w3.org/1999/02/22-rdf-syntax-ns#type | http://www.w3.org/2002/07/owl#ObjectProperty |
| http://example.org/meta#hasEntityConcept | http://www.w3.org/2000/01/rdf-schema#label | has entity concept |

クエリ出力ではturtleのような短縮形ではなくフルのURIでの表示だが、どちらも同じ内容であることが見て取れるだろう。turtleはRDBでいうところの正規化っぽい書き方、ともいえよう。また、ここでも前述同様「青字がリソース、黒字がリテラル」である。

---

RDFの世界で「目に見えるものが何で」「それがどんな意味か」について、クラスとリテラルは大体わかったような気がする。しかしプロパティはもう少し掘る必要があるのでこれを次回取り上げることにしよう。

(Part13につづく)
